<%@page import="adm.alumno.spring.AdmAcademico"%>
<%@page import="adm.catalogo.spring.CatCarrera"%>

<%@ include file= "../head.jsp"%>
<%@ include file= "../menu.jsp"%>

<%@ page import= "java.util.*"%>

<head> 
	<link rel="STYLESHEET" href="/admision.css"  type="text/css">
	<script src="js/jquery-1.5.1.min.js" type="text/javascript"></script>
  	<script src='js/Globo/jquery.tinyTips2.js' type='text/javascript'></script>		
	<style>		
		body{
			background-image: url("<%=request.getContextPath()%>/imagenes/Biblioteca.png");
			/* Para dejar la imagen de fondo centrada, vertical y horizontalmente */
			background-position: center center;
			/* La imagen se fija en la ventana de visualizaciÃ³n para que la altura de la imagen no supere a la del contenido */
			background-attachment: fixed;
			background-repeat: no-repeat;
			/* La imagen de fondo se reescala automÃ¡ticamente con el cambio del ancho de ventana del navegador */
			background-size: cover;	
		} 
		a {text-decoration: none;} 
		a:hover {text-decoration: underline;} 
		.tabla td{padding:5px;}
		
		.tinyTip {
			width: 325px;
			padding: 17px 0px 0px 0px;
			display: block;
			background: url(js/Globo/tinyTip-top.png) 0px 0px no-repeat;
		}
		.tinyTip .content {
			padding: 0px 15px 0px 15px;
			font-size: 14px;
			font-family: "Lucida Sans Unicode";
			color: #010101;
			background: url(js/Globo/tinyTip-content.png) 0px 0px repeat-y;
		}
		.tinyTip .bottom {
			height: 47px;
			background: url(js/Globo/tinyTip-bottom.png) 0px 0px no-repeat;
			font: 0px/0px sans-serif;
		}
		.fa{
			color: black;
		}
		a> .fa{
			color: #337ab7;
		}
		
		@media (min-width: 587px) {
			.col-md-3{
				float: left;
				margin-left: 85px;
			}
		}
		@media (min-width: 764px) {
			.col-md-3{
				float: left;
				margin-left: 0;
			}		
		}
		@media (min-width: 480px) {
			.col-md-5{
				float: left;
			}
		}	
	</style>		
</head>
<%
	
	String folio 		= (String)session.getAttribute("Folio")==null?"0":(String)session.getAttribute("Folio");
	String mensaje		=  request.getParameter("Mensaje")==null?"0":request.getParameter("Mensaje");
	
	AdmAcademico admAcademico 	= (AdmAcademico) request.getAttribute("admAcademico");
	boolean existeAcademico 	= (boolean) request.getAttribute("existeAcademico");	
	String colorGrabar			= existeAcademico?"style='color:purple'":"style='color:orange'";
	String modalidad 			= admAcademico.getModalidad();	

	HashMap<String,String> mapaNivel 	= (HashMap<String,String>) request.getAttribute("mapaNivel");
	HashMap<String,String> mapaFacultad = (HashMap<String,String>) request.getAttribute("mapaFacultad");
	
	List<CatCarrera> lisCarrera = (List<CatCarrera>) request.getAttribute("lisCarrera");
	
	// ----------------CALCULAR FECHAS-----------------------------
	String [] fecha = adm.fecha.Fecha.getHoy().split("/");
	int mes 		= Integer.parseInt(fecha[1]);
	int year		= Integer.parseInt(fecha[2]);
	
	ArrayList<String> fechas = new ArrayList<String>();
	
	if(!modalidad.equals("")){
		int agosto = 8;
		int enero  = 1;
		int junio  = 6;
		
		String f1  = "";
		String f2  = "";
		String f3  = "";
		
		if(mes>agosto){
			f1 = (year+1)+"08";
		}else{
			f1 = year+"08";
		}
		
		if(mes>enero){
			f2 = (year+1)+"01";
		}else{
			f2 = year+"01";
		}
		
		fechas.add(f1);
		fechas.add(f2);
		
		if(modalidad.equals("1")){//Si es Presencial
			if(mes>junio){
				f3 = (year+1)+"06";
			}else{
				f3 = year+"06";
			}
			fechas.add(f3);
		}
	}
	Collections.sort(fechas);
	
	ArrayList<String> FECHAS = new ArrayList<String>();
	for(String str:fechas){
		String date = "";
		String tmp  = str.substring(4,6);
		if(tmp.equals("01")){
			date="Enero";
		}else if(tmp.equals("06")){
			date="Junio";
		}else if(tmp.equals("08")){
			date="Agosto";
		}
		
		date = date+"/";
		date = date+str.substring(0,4);
		FECHAS.add(date);
	}
	
	//--------------------------------------------------------------
%>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-1" style="background-color:rgba(255, 255, 255, 0.7);">
				<span class="btn btn-outline-light" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/registro" style="color:black">					
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Datos usuario"><i class="fas fa-user fa-2x"></i><br>Cuenta</span>&nbsp;
					</a>
				</span>
				<span class="btn btn-outline-light" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/solicitud/modalidad" style="color:black">					
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Solicitud de admisión"><i class="far fa-file-alt fa-2x"></i><br>Solicitud</span>&nbsp;
					</a>
				</span>			
				<span class="btn btn-outline-light" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/documentos/documentos" style="color:black">					
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Documentos de ingreso"><i class="fas fa-tasks fa-2x"></i><br>Documentos</span>&nbsp;
					</a>
				</span>					
				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/directo/ingreso" style="color:black">
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Ingreso directo"><i class="fas fa-door-open fa-2x"></i><br>Ingreso</span>&nbsp;
					</a>
				</span>					
				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/referencias?Folio=<%=folio%>" style="color:black">
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Pago en linea"><i class="fas fa-credit-card fa-2x"></i><br>Pago</span>&nbsp;
					</a>
				</span>					
				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/cita/evento" style="color:black">
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Reservar examen"><i class="far fa-calendar-alt fa-2x"></i><br>Examen</span>&nbsp;
					</a>
				</span>					
				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/resultados/resultados" style="color:black">
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Resultados examen"><i class="fas fa-trophy fa-2x"></i><br>Resultados</span>&nbsp;
					</a>
				</span>					
				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/solicitud/admitidoPDF" style="color:black">
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Carta de admisi&oacute;n"><i class="fas fa-envelope fa-2x"></i><br>Carta</span>&nbsp;
					</a>
				</span>					
			</div>
			<div class="col-lg-11" style="background-color:white; min-height:calc(100vh - 37px);">
				<div class="d-flex justify-content-start">
					<div class="d-flex align-items-center">
				    	<a href="<%=request.getContextPath()%>/solicitud/nivel"><i class="fas fa-caret-left fa-3x"></i></a>
				    	&nbsp;<b class="fs-5">3/7</b>&nbsp;
<%					if(!admAcademico.getCarreraId().equals("00000") && !admAcademico.getCarreraId().equals("0")){ %>
				    	<a href="<%=request.getContextPath()%>/solicitud/datos"><i class="fas fa-caret-right fa-3x"></i></a>
<%					}else{out.print("&nbsp;");}%>	      
					</div>
				</div>
				<div class="page-header">
					<h1><i class="far fa-check-circle" aria-hidden="true" <%=colorGrabar%>></i>&nbsp;<spring:message code="adm.Carrera"/></h1>
				</div>	
				<div class="alert alert-info" role="alert">
					<p><spring:message code="solicitud.carrera.CarreraEstudios"/>:</p>
				</div>
				<br>
				<div class="well">
					<div class="col-md-7">
						<form id="frmCarrera" name="frmCarrera" action="grabarCarrera" method="post">
							<label><b><spring:message code="adm.Carrera"/>: </b></label>
						    <select class="form-control selectpicker" id="CarreraId" name="CarreraId" style="width:400px;" data-live-search="true">
<%				String fac 			= "";
				String nivelTemp 	= "";
				String anotacion	= "";
				
				 for (CatCarrera carrera : lisCarrera){
					// Texto informativo para que los alumnos de rumania sepan que carrera elegir		
					if(carrera.getNivelId().equals(admAcademico.getNivelId())){
						if(!carrera.getNivelId().equals(nivelTemp)){
						    nivelTemp = carrera.getNivelId();
%>
								<optgroup style = "font-size:10pt; font-weight:bold;" label="<%=mapaNivel.containsKey(nivelTemp)?mapaNivel.get(nivelTemp):"-" %> "></optgroup>
<% 						}	
						if(!carrera.getFacultadId().equals(fac)){
							fac = carrera.getFacultadId();	
%>					
								&nbsp;<optgroup style = "font-size:11pt; font-weight:bold;" label="-<%=mapaFacultad.containsKey(fac)?mapaFacultad.get(fac):"-" %> "></optgroup>
			
<%						}
						if (carrera.getCarreraId().equals("10228")||carrera.getCarreraId().equals("10216")) anotacion =" (Rumania)"; else anotacion = "";
%>
								<option style = "font-size:9pt;" value="<%=carrera.getCarreraId() %>" title="<%= carrera.getNombreCarrera() %>" <%if(carrera.getCarreraId().equals(admAcademico.getCarreraId()))out.print("selected"); %>><%= carrera.getCarreraId()+" - "+ carrera.getNombreCarrera() %><%=anotacion%></option>	
<%					}
				}
%>			
							</select>
				        	<br>
					 		<label><b><spring:message code="adm.Fecha"/>:</b></label>
						  	<select class="form-control" name="Fecha" style="max-width:250px;">
<%							for(String str : FECHAS){ 
					  	    	String value = "01/";
					  	    	String [] tmp = str.split("/");
					  	    	if(tmp[0].equals("Junio")){
					  	    		value = value+"06/"+tmp[1];
					  	    	}else if(tmp[0].equals("Agosto")){
					  	    		value = value+"08/"+tmp[1];	
					  	    	}else if(tmp[0].equals("Enero")){
					  	    		value = value+"01/"+tmp[1];
					  	    	}
					  	    	
					  	    	String f = admAcademico.getFecha()==null?"":admAcademico.getFecha();
					  	    	if(str.equals("Junio/2012")){
					  	    		str = "Curso intensivo Verano(s&oacute;lo algunos programas no formales y postgrados)";
					  	    	}
					  	    	else if(str.equals("Agosto/2012")){
					  	    		str = "I Semestre inicio del curso escolar ("+str.replaceAll("/", " ")+")";
					  	    	}
					  	    	else if(str.equals("Enero/2013")){
					  	    		str = " II Semestre curso escolar ("+str.replaceAll("/", " ")+")";
					  	    	}
%>
				  	   			<option style = "font-size:7pt;" value="<%=value %>" title="<%=value %>" <%if(value.equals(f))out.print("selected"); %>><%=str %></option>	
<%							} %>			
					  	    </select>
				  	    	<br>
							<button type="button" class="btn alert-info" onclick="document.frmCarrera.submit();">
							 	<spring:message code="adm.Continuar"/> <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
							</button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
<% if (mensaje.equals("1")){%>
	<table align="center"><tr><td><spring:message code="solicitud.carrera.GraboCarrera"/></td></tr></table>
	<meta http-equiv="refresh" content="1;url=datos" />
<%}else if(mensaje.equals("2")||mensaje.equals("3")){%>
	<table align="center"><tr><td><spring:message code="solicitud.carrera.NoGraboCarrera"/></td></tr></table>
<%}else if (mensaje.equals("4")){%>
	<table align="center"><tr><td><spring:message code="solicitud.carrera.NoExisteCarrera"/></td></tr></table>
<%}%>