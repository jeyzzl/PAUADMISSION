<%@page import="java.util.List"%>

<%@ include file= "../head.jsp"%>
<%@ include file= "../menu.jsp"%>

<%@page import="adm.alumno.spring.AdmEstudio"%>
<%@page import="adm.alumno.spring.AdmAcademico"%>
<%@page import="adm.alumno.spring.AdmSolicitud"%>
<%@page import="adm.alumno.spring.AdmCartaSubir"%>
<%@page import="adm.catalogo.spring.CatPais"%>
<%@page import="adm.catalogo.spring.CatEstado"%>
<%@page import="adm.catalogo.spring.CatCiudad"%>

<head> 
	<link rel="STYLESHEET" href="/admision.css"  type="text/css">
	<script src="js/jquery-1.5.1.min.js" type="text/javascript"></script>
  	<script src='js/Globo/jquery.tinyTips2.js' type='text/javascript'></script>		
	<style>		
		body{
			background-image: url("<%=request.getContextPath()%>/imagenes/Biblioteca.png");
			/* Para dejar la imagen de fondo centrada, vertical y horizontalmente */
			background-position: center center;
			/* La imagen se fija en la ventana de visualizaci�n para que la altura de la imagen no supere a la del contenido */
			background-attachment: fixed;
			background-repeat: no-repeat;
			/* La imagen de fondo se reescala autom�ticamente con el cambio del ancho de ventana del navegador */
			background-size: cover;	
		} 
		a {text-decoration: none;} 
		a:hover {text-decoration: underline;} 
		.tabla td{padding:5px;}
		
		.tinyTip {
			width: 325px;
			padding: 17px 0px 0px 0px;
			display: block;
			background: url(js/Globo/tinyTip-top.png) 0px 0px no-repeat;
		}
		.tinyTip .content {
			padding: 0px 15px 0px 15px;
			font-size: 14px;
			font-family: "Lucida Sans Unicode";
			color: #010101;
			background: url(js/Globo/tinyTip-content.png) 0px 0px repeat-y;
		}
		.tinyTip .bottom {
			height: 47px;
			background: url(js/Globo/tinyTip-bottom.png) 0px 0px no-repeat;
			font: 0px/0px sans-serif;
		}
		.fa{
			color: black;
		}
		a> .fa{
			color: #337ab7;
		}
		
		@media (min-width: 587px) {
			.col-md-3{
				float: left;
				margin-left: 85px;
			}
		}
		@media (min-width: 764px) {
			.col-md-3{
				float: left;
				margin-left: 0;
			}		
		}
		@media (min-width: 480px) {
			.col-md-5{
				float: left;
			}
		}	
	</style>	
<script type="text/javascript">

	function revisa(){
		var titulo 		= document.getElementById("titulo").value;
		var institucion = document.getElementById("institucion").value;
		
		if(titulo != "-" && titulo != ""){
			if(institucion != "-" && institucion != ""){
				if($("nacPais").value != "0"){
					return true;
				}else{
					alert("Country is required");
					$("nacPais").focus();
				}
			}else{
				alert("Institution is required");
				$("institucion").focus();
			}
		}else{
			alert("Degree is required");
			$("titulo").focus();
		}
		return false;
	}
	
	function grabar(){
		if(revisa()){
 			document.frmEstudio.submit();
		}
	}
	
	function modificar(){
		if(revisa()){
			document.frmEstudio.submit();
		}
	}

	function refreshEstados(){	
					
		jQuery('#nacEdo').html('<option>Updating</option>');		
		var paisId = jQuery('#nacPais').val();		
		jQuery("#nacEdo").empty();		
		jQuery.get('getEstados?paisId='+paisId, function(data){
			jQuery("#nacEdo").html(data);			
			refreshCuidades();
		});		
	}

	function refreshCiudades(){
		jQuery('#nacCiudad').html('<option>Updating</option>');				
		var paisId 		= jQuery('#nacPais').val();
		var estadoId 	= jQuery('#nacEdo').val();				
		jQuery.get('getCiudades?paisId='+paisId+'&estadoId='+estadoId, function(data){
			jQuery("#nacCiudad").html(data);
		});
	}
	
	function cambiaEstudios(){
		var nivel 				= jQuery("#estudios").val();
		var textoInicio 		= "Month and year of start";
		var textoFinal 			= "Month and year of end"; 
		var textoInstitucion 	= "Institution";
		var texto 				= "-";
		
		if (nivel=="1") texto = " elementary"; 
		if (nivel=="2") texto = " secondary";
		if (nivel=="3") texto = " high school";
		if (nivel=="4") texto = " college";
		if (nivel=="5") texto = " bachelor's degree";
		if (nivel=="6") texto = " speciality";
		if (nivel=="7") texto = " master's degree";
		if (nivel=="8") texto = " doctorate";
		
		textoInicio 		+= texto;
		textoFinal 			+= texto;
		textoInstitucion 	+= texto;
		
		jQuery("#labelInicio").html(textoInicio);
		jQuery("#labelFinal").html(textoFinal);
		jQuery("#labelInstitucion").html(textoInstitucion);
	}	
</script>
</head>
<% 
	String folio 		= session.getAttribute("Folio")==null?"0":(String)session.getAttribute("Folio");
	String otro			= request.getParameter("Otro")==null?"N":request.getParameter("Otro");
	String id			= (String) request.getAttribute("id");
	String completo		= (String) request.getAttribute("completo");
	String convalida	= (String) request.getAttribute("convalida");
	int registros		= (int) request.getAttribute("registros");	
	int niv 			= (int) request.getAttribute("niv");
	AdmEstudio estudio 	= (AdmEstudio) request.getAttribute("estudio");	
	AdmSolicitud admSolicitud 	= (AdmSolicitud) request.getAttribute("admSolicitud");	
	AdmCartaSubir admCartaSubir = (AdmCartaSubir)request.getAttribute("admCartaSubir");
	boolean grabo 		= (boolean) request.getAttribute("grabo");
	boolean existe		= (boolean)request.getAttribute("existe");
	String colorGrabar	= existe?"style='color:purple'":"style='color:orange'";
	String paisId 		= estudio.getPaisId().equals("0") ? "147" : estudio.getPaisId();
	String estadoId 	= estudio.getEstadoId().equals("0") ? "1" : estudio.getEstadoId();
	
	List<CatPais> lisPais		= (List<CatPais>) request.getAttribute("lisPais");
	List<CatEstado> lisEstados	= (List<CatEstado>) request.getAttribute("lisEstados");
	List<CatCiudad> lisCiudad	= (List<CatCiudad>) request.getAttribute("lisCiudad");	
	
%>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-1" style="background-color:rgba(255, 255, 255, 0.7);">
				<span class="btn btn-outline-light" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/registro" style="color:black">					
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Datos usuario"><i class="fas fa-user fa-2x"></i><br>Account</span>&nbsp;
					</a>
				</span>
				<span class="btn btn-outline-light" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/solicitud/modalidad" style="color:black">					
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Solicitud de admisi�n"><i class="far fa-file-alt fa-2x"></i><br>Application</span>&nbsp;
					</a>
				</span>			
				<span class="btn btn-outline-light" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/documentos/documentos" style="color:black">					
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Documentos de ingreso"><i class="fas fa-tasks fa-2x"></i><br>Documents</span>&nbsp;
					</a>
				</span>					
<!-- 				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;"> -->
<%-- 					<a href="<%=request.getContextPath()%>/directo/ingreso" style="color:black"> --%>
<!-- 						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Ingreso directo"><i class="fas fa-door-open fa-2x"></i><br>Entry</span>&nbsp; -->
<!-- 					</a> -->
<!-- 				</span>					 -->
				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;">
					<a href="<%=request.getContextPath()%>/referencias?Folio=<%=folio%>" style="color:black">
						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Pago en linea"><i class="fas fa-credit-card fa-2x"></i><br>Fees</span>&nbsp;
					</a>
				</span>					
<!-- 				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;"> -->
<%-- 					<a href="<%=request.getContextPath()%>/cita/evento" style="color:black"> --%>
<!-- 						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Reservar examen"><i class="far fa-calendar-alt fa-2x"></i><br>Test</span>&nbsp; -->
<!-- 					</a> -->
<!-- 				</span>					 -->
<!-- 				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;"> -->
<%-- 					<a href="<%=request.getContextPath()%>/resultados/resultados" style="color:black"> --%>
<!-- 						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Resultados examen"><i class="fas fa-trophy fa-2x"></i><br>Test Results</span>&nbsp; -->
<!-- 					</a> -->
<!-- 				</span>					 -->
<!-- 				<span class="btn btn-outline-light tip" style="width: 100px; font-size: 13px;"> -->
<%-- <% 				String colorCarta = "black"; --%>
<!-- // 				if(admCartaSubir.getCarta() != null){	 -->
<!-- // 					colorCarta = "green";										 -->
<%--  				}%>												 --%>
<%-- 				<a href="<%=request.getContextPath()%>/descargarCartaAdmision" style="color:<%=colorCarta%>"> --%>
<!-- 						<span data-bs-toggle="tooltip" data-bs-placement="right" title="Carta de admisi&oacute;n"><i class="fas fa-envelope fa-2x"></i><br>Letter</span>&nbsp; -->
<!-- 					</a> -->
<!-- 				</span>					 -->
			</div>
			<div class="col-lg-11" style="background-color:white; min-height:calc(100vh - 37px);">
				<div class="d-flex bd-highlight page-header">
					<div class="p-2 w-100 bd-highlight">			
						<h2><i class="fas fa-check-circle" aria-hidden="true" <%=colorGrabar%>></i>&nbsp;<spring:message code="solicitud.estudios.Antecedentes"/></h2>
					</div>	
<!-- 					<div class="p-2 flex-shrink-1 bd-highlight"> -->
<!-- 						<div class="d-flex align-items-center"> -->
<%-- 							<a href="<%=request.getContextPath()%>/solicitud/padres"><i class="fas fa-caret-left fa-3x"></i></a> --%>
<!-- 							&nbsp;<b class="fs-5">4/9</b>&nbsp; -->
<%-- <%					if(registros >= 1){ %> --%>
<%-- 							<a href="<%=request.getContextPath()%>/solicitud/otroEstudio"><i class="fas fa-caret-right fa-3x"></i></a> --%>
<%-- <%					}else{ --%>
<!--  						out.print("&nbsp;"); -->
<!--  					} -->
<%-- %>	      --%>
<!-- 						</div>						 -->
<!-- 					</div>			 -->
				</div>
				<div class="alert alert-info" role="alert">
					<a href="<%=request.getContextPath()%>/solicitud/otroEstudio"><i class="fas fa-arrow-left fa-2x"></i></a> <spring:message code="solicitud.estudios.MensajeAntecedentes"/>
				</div>
				<div class="well">
					<div class="row">
						<form id="frmEstudio" name="frmEstudio" action="grabarEstudios" method="post">
							<input name="Convalida" type="hidden" value=<%=convalida%>>
							<input name="Id" type="hidden" value="<%=id%>">
							<div class="col-md-6">
<%							if(niv < 3){%>
								<label><spring:message code="solicitud.estudios.UltimoNivel"/></label>
								<select id="estudios" name="estudios" class="form-select" onchange="javascript:cambiaEstudios();">
									<option value="1" <%=estudio.getEstudios().equals("1")?"selected":""%>><spring:message code="solicitud.estudios.Primaria"/></option>
									<option value="2" <%=estudio.getEstudios().equals("2")?"selected":""%>><spring:message code="solicitud.estudios.Secundaria"/></option>		
									<option value="3" <%=estudio.getEstudios().equals("3")?"selected":""%>><spring:message code="solicitud.estudios.Bachillerato"/></option>
									<option value="4" <%=estudio.getEstudios().equals("4")?"selected":""%>><spring:message code="solicitud.estudios.Tecnica"/></option>
									<option value="5" <%=estudio.getEstudios().equals("5")?"selected":""%>><spring:message code="solicitud.estudios.Licenciatura"/></option>
									<option value="6" <%=estudio.getEstudios().equals("6")?"selected":""%>><spring:message code="solicitud.estudios.Especializacion"/></option>
									<option value="7" <%=estudio.getEstudios().equals("7")?"selected":""%>><spring:message code="solicitud.estudios.Maestria"/></option>
									<option value="8" <%=estudio.getEstudios().equals("8")?"selected":""%>><spring:message code="solicitud.estudios.Doctorado"/></option>		
								</select>&nbsp;&nbsp;<br>
								<label><spring:message code="solicitud.estudios.TituloAlcanzado"/>:</label>
								<input class="form-control" style="size:300px;" type="text" id="titulo" name="titulo" maxlength="70" value="<%=estudio.getTitulo()%>"/><br>
		<%-- 						<label id="labelInicio"><spring:message code="solicitud.estudios.MesYearInicio"/></label> --%>
								<input class="form-control input input-medium" title="Capture mes y a&ntilde;o" type="hidden" id="inicio" name="inicio" size="20" maxlength="30" value="<%= estudio.getInicio()%>"/>
		<%-- 						<label id="labelFinal"><spring:message code="solicitud.estudios.MesYearFinalizacion"/></label>	 --%>
		<%-- 						<input class="form-control input input-medium" title="Capture mes y a&ntilde;o" type="hidden" id="fin" name="fin" size="20" maxlength="30" value="<%= estudio.getFin()%>"/>   --%>
								<label id="labelInstitucion"><spring:message code="solicitud.estudios.Institucion"/></label>
								<input class="form-control" type="text" id="institucion" name="institucion" size="40" maxlength="70" value="<%= estudio.getInstitucion()%>"/>
<%							}
							if(niv >= 3){%>
								<label><spring:message code="solicitud.estudios.UltimoNivel"/></label>&nbsp;
								<select id="estudios" name="estudios" class="form-select">
									<option value="0" <%=estudio.getEstudios().equals("0")?"selected":""%>><spring:message code="solicitud.estudios.Elige"/>...</option>
									<option value="1" <%=estudio.getEstudios().equals("1")?"selected":""%>><spring:message code="solicitud.estudios.Primaria"/></option>
									<option value="2" <%=estudio.getEstudios().equals("2")?"selected":""%>><spring:message code="solicitud.estudios.Secundaria"/></option>		
									<option value="3" <%=estudio.getEstudios().equals("3")?"selected":""%>><spring:message code="solicitud.estudios.Bachillerato"/></option>
									<option value="4" <%=estudio.getEstudios().equals("4")?"selected":""%>><spring:message code="solicitud.estudios.Tecnica"/></option>
									<option value="5" <%=estudio.getEstudios().equals("5")?"selected":""%>><spring:message code="solicitud.estudios.Licenciatura"/></option>
									<option value="6" <%=estudio.getEstudios().equals("6")?"selected":""%>><spring:message code="solicitud.estudios.Especializacion"/></option>
									<option value="7" <%=estudio.getEstudios().equals("7")?"selected":""%>><spring:message code="solicitud.estudios.Maestria"/></option>
									<option value="8" <%=estudio.getEstudios().equals("8")?"selected":""%>><spring:message code="solicitud.estudios.Doctorado"/></option>
								</select>&nbsp;&nbsp;<br>
								<label><spring:message code="solicitud.estudios.TituloAlcanzado"/></label>&nbsp;
								<input class="form-control" title="licenciatura o equivalete" type="text" id="titulo" name="titulo" size="40" maxlength="70" value="<%=estudio.getTitulo()==null?"":estudio.getTitulo()%>"/><br>
		<%-- 						<label id="labelInicio"><spring:message code="solicitud.estudios.MesYearInicio"/></label> --%>
		<%-- 						<input class="form-control input input-medium" title="Capture mes y a&ntilde;o" type="text" id="inicio" name="inicio" size="20" maxlength="30" value="<%= estudio.getInicio()%>"/><br> --%>
		<%-- 						<label id="labelFinal"><spring:message code="solicitud.estudios.MesYearFinalizacion"/></label>	 --%>
		<%-- 						<input class="form-control input input-medium" title="Capture mes y a&ntilde;o" type="text" id="fin" name="fin" size="20" maxlength="30" value="<%= estudio.getFin()%>"/><br> --%>
		<%-- 						<label><spring:message code="solicitud.estudios.MasDeUna"/></label><br>	 --%>
		<%-- 						<input type="radio" name="Convalida" value="S" <% if (estudio.getConvalida().equals("S")) out.print("Checked"); %>  />&nbsp;&nbsp;<b>Si</b>&nbsp;&nbsp;&nbsp; --%>
		<%-- 						<input type="radio" name="Convalida" value="N" <% if (estudio.getConvalida().equals("N")) out.print("Checked"); %> />&nbsp;&nbsp;<b>No</b><br><br> --%>
		<%-- 						<label><spring:message code="solicitud.estudios.TerminoEstudios"/></label>&nbsp;&nbsp; --%>
		<%-- 						<input type="radio" name="completo" value="S" <% if (estudio.getCompleto().equals("S")) out.print("Checked"); %>  />&nbsp;&nbsp;<b>Si</b>&nbsp;&nbsp; --%>
		<%-- 						<input type="radio" name="completo" value="N" <% if (estudio.getCompleto().equals("N")) out.print("Checked"); %> />&nbsp;&nbsp;<b>No</b><br><br>		 --%>
								<label id="labelInstitucion"><spring:message code="solicitud.estudios.Institucion"/></label>
								<input class="form-control" type="text" id="institucion" name="institucion" size="40" maxlength="70" value="<%= estudio.getInstitucion()%>"/>
<%							}%>
							</div><br>
							<div class="col-md-6">		
<%-- 								<label><spring:message code="solicitud.estudios.DependenciaEducativa"/></label> --%>
<%-- 								<input class="form-control" title="Nombre de la dependencia si existe" type="text" id="dependencia" name="dependencia" size="40" maxlength="70" value="<%= estudio.getDependencia()%>"/><br> --%>
							   	<label><spring:message code="adm.Pais"/></label> 
							    <select class="form-select selectpicker" id="nacPais" name="nacPais" data-live-search="true" onChange="javascript:refreshEstados();">
<%								for(int i=0; i<lisPais.size(); i++){
									CatPais pais = lisPais.get(i);%>
									<option value="<%=pais.getPaisId() %>" <%=pais.getPaisId().equals(paisId)?"Selected":"" %>><%=pais.getNombrePais() %></option>
<%								} %>
								</select>
								
								<br>
								<label id="labelFin">Year Completed</label>
								<input class="form-control" type="text" id="fin" name="fin" size="40" maxlength="70" value="<%= estudio.getFin()%>"/>
<%-- 						<label><spring:message code="adm.Estado"/> </label>     --%>
<!-- 						<select class="form-select" id="nacEdo" name="nacEdo" onChange="javascript:refreshCiudades();"> -->
<%-- <%						if (lisEstados.size()>0){						 --%>
<!-- 							for(CatEstado estado : lisEstados){ -->
<!-- 								String elegir = estado.getEstadoId().equals(estadoId)?" selected":"";   -->
<!-- 								out.print("<option value='"+estado.getEstadoId()+"' "+elegir+">"+estado.getNombreEstado()+"</option>"); -->
<!-- 							}	 -->
<!-- 						}else{ -->
<!-- 							out.print("<option value='0'>Sin registrar</option>"); -->
<!-- 						}%>			 -->
<!-- 		    			</select> -->
<br>
<%-- 						<label><spring:message code="adm.Ciudad"/></label> --%>
<!-- 						<select class="form-select" id="nacCiudad" name="nacCiudad" > -->
<%-- <%						String ciudadId = "1"; --%>
<!-- 						if(estudio.getCiudadId()!=null&&!estudio.getCiudadId().trim().equals("")){ -->
<!-- 							ciudadId = estudio.getCiudadId(); -->
<!-- 						} -->
<!-- 						for(int i = 0; i < lisCiudad.size(); i++){ -->
<!-- 							CatCiudad ciudad = lisCiudad.get(i);%> -->
<%-- 	         				<option value="<%=ciudad.getCiudadId() %>" <%=ciudad.getCiudadId().equals(ciudadId)?"Selected":"" %>><%=ciudad.getNombreCiudad() %></option> --%>
<%-- <%						}%> --%>
<!-- 	     	 			</select> -->
<%-- 				       	<label><spring:message code="solicitud.estudios.MateriasAprobadas"/></label> --%>
<!-- 				       	<select class="form-select" id="OtraMateria" name="OtraMateria" > -->
<%-- 				         	<option value="No" <%=estudio.getOtraMateria().equals("No")?"selected":""%>>No</option> --%>
<%-- 				         	<option value="Si" <%=estudio.getOtraMateria().equals("Si")?"selected":""%>>Si</option> --%>
<!-- 				       	</select> -->
								<input type="hidden" name="OtraMateria" size="40" maxlength="70" value="No"/>
							</div>
<%-- 					<p><spring:message code="solicitud.estudios.Convalidadcion"/></p> --%>
<%-- 					<p><spring:message code="solicitud.estudios.ParaConvalidar"/></p> --%>
							<div class="col-md-6">		
								<button type="button" class="btn alert-info" onclick="grabar();">
									<spring:message code="adm.Siguiente"/> <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</body >
<script>
	$('#Fecha').datepicker();	
</script>
<% if (grabo){%>
	<table align="center"><tr><td><spring:message code="solicitud.estudios.Grabo"/></td></tr></table>
	<meta http-equiv="refresh" content="1;url=otroEstudio" />
<%}%>