<%@ include file= "../head.jsp"%>
<%@ include file= "../menu.jsp"%>

<%@page import="java.util.List"%>
<%@page import="java.util.HashMap"%>

<%@page import="adm.alumno.spring.AdmUsuario"%>
<%@page import="adm.alumno.spring.AdmSolicitud"%>
<%@page import="adm.alumno.spring.AdmAcademico"%>
<%@page import="adm.alumno.spring.AdmTutor"%>
<%@page import="adm.alumno.spring.AdmSalud"%>
<%@page import="adm.alumno.spring.AdmPadres"%>
<%@page import="adm.alumno.spring.AdmEstudio"%>
<%@page import="adm.alumno.spring.AdmRecomienda"%>
<%@page import="adm.catalogo.spring.CatPais"%>
<%@page import="adm.alumno.spring.AdmCartaSubir"%>

<head>
	<link rel="STYLESHEET" href="/admision.css"  type="text/css">
	<script src="js/jquery-1.5.1.min.js" type="text/javascript"></script>
  	<script src='js/Globo/jquery.tinyTips2.js' type='text/javascript'></script>		
	<style>		
		body{
			background-image: url("<%=request.getContextPath()%>/imagenes/Biblioteca.png");
			/* Para dejar la imagen de fondo centrada, vertical y horizontalmente */
			background-position: center center;
			/* La imagen se fija en la ventana de visualizaci�n para que la altura de la imagen no supere a la del contenido */
			background-attachment: fixed;
			background-repeat: no-repeat;
			/* La imagen de fondo se reescala autom�ticamente con el cambio del ancho de ventana del navegador */
			background-size: cover;	
		} 
		a {text-decoration: none;} 
		a:hover {text-decoration: underline;} 
		.tabla td{padding:5px;}
		
		.tinyTip {
			width: 325px;
			padding: 17px 0px 0px 0px;
			display: block;
			background: url(js/Globo/tinyTip-top.png) 0px 0px no-repeat;
		}
		.tinyTip .content {
			padding: 0px 15px 0px 15px;
			font-size: 14px;
			font-family: "Lucida Sans Unicode";
			color: #010101;
			background: url(js/Globo/tinyTip-content.png) 0px 0px repeat-y;
		}
		.tinyTip .bottom {
			height: 47px;
			background: url(js/Globo/tinyTip-bottom.png) 0px 0px no-repeat;
			font: 0px/0px sans-serif;
		}
		.fa{
			color: black;
		}
		a> .fa{
			color: #337ab7;
		}
		
		@media (min-width: 587px) {
			.col-md-3{
				float: left;
				margin-left: 85px;
			}
		}
		@media (min-width: 764px) {
			.col-md-3{
				float: left;
				margin-left: 0;
			}		
		}
		@media (min-width: 480px) {
			.col-md-5{
				float: left;
			}
		}	
	</style>	
	<script type="text/javascript">
		function confirmar(){
			if(confirm("If you accept the commitment of the application, click on Accept")){
				document.frmconfirmar.estado.value="C";
				document.frmconfirmar.submit();
			}
		}
		
		function botonConfirmar(){
			if (document.getElementById('acepto').checked){
				document.getElementById('botonConf').style.display = 'block';
			}else{
				document.getElementById('botonConf').style.display = 'none';
			}
		}	
		
	</script>
</head>
<%
	String folio 				= (String)session.getAttribute("Folio")==null?"0":(String)session.getAttribute("Folio");
	List<String> opciones		= (List<String>)session.getAttribute("Opciones");
	AdmUsuario admUsuario 		= (AdmUsuario)request.getAttribute("admUsuario");
	AdmSolicitud admSolicitud 	= (AdmSolicitud)request.getAttribute("admSolicitud");
	AdmAcademico admAcademico 	= (AdmAcademico)request.getAttribute("admAcademico");
	AdmTutor admTutor 			= (AdmTutor)request.getAttribute("admTutor");
	AdmSalud admSalud 			= (AdmSalud)request.getAttribute("admSalud");
	AdmPadres admPadres 		= (AdmPadres)request.getAttribute("admPadres");
	AdmCartaSubir admCartaSubir = (AdmCartaSubir)request.getAttribute("admCartaSubir");
	
	String estado 			= request.getParameter("estado")==null ? "" : request.getParameter("estado");
	String edad				= (String)request.getAttribute("edad");
     
	String ciudad 			= (String)request.getAttribute("ciudad");
	String estadoId    		= (String)request.getAttribute("estadoId");
    String paisId   	 	= (String)request.getAttribute("paisId");
    String nacionalidad  	= (String)request.getAttribute("nacionalidad");
    String religion    		= (String)request.getAttribute("religion");
	String cdUb 			= (String)request.getAttribute("cdUb");
	String edoUb 			= (String)request.getAttribute("edoUb");
	String paisUb 			= (String)request.getAttribute("paisUb");
	String nombreCarrera 	= (String)request.getAttribute("nombreCarrera");
	
	String padreReligion 	= (String)request.getAttribute("padreReligion");
	String padreNac		 	= (String)request.getAttribute("padreNac");
	String madreReligion 	= (String)request.getAttribute("madreReligion");
	String madreNac		 	= (String)request.getAttribute("madreNac");
	
	List<AdmEstudio> lista 		= (List<AdmEstudio>)request.getAttribute("lista");
	List<AdmRecomienda> listaR 	= (List<AdmRecomienda>)request.getAttribute("listaR");
	
	
	
	HashMap<String,CatPais> mapaPaises = (HashMap<String,CatPais>)request.getAttribute("mapaPaises");
%>
<body>
	<div class="container-fluid">
		<div class="row">
			<%@ include file= "../opciones.jsp"%>
			<div class="col-lg-11" style="background-color:white; min-height:calc(100vh - 37px);">
<% 		if(!estado.equals("C") && !estado.equals("F")){ %>			
				<div class="d-flex bd-highlight page-header">	
					<div class="p-2 w-100 bd-highlight">	 
						<h2><spring:message code="solicitud.confirmar.Confirmacion"/></h2>
					</div>
					<div class="p-2 flex-shrink-1 bd-highlight">
						<div class="d-flex align-items-center">
<%					if (!admAcademico.getCarreraId().equals("10501") && !admUsuario.getPaisId().equals("108") && !admAcademico.getNivelId().equals("5")){%>
				    		<a href="<%=request.getContextPath()%>/solicitud/recomendaciones"><i class="fas fa-caret-left fa-3x"></i></a>
				    		&nbsp;<b class="fs-5">8/8</b>&nbsp;
<% 						}else{%>
							<a href="<%=request.getContextPath()%>/solicitud/tutor"><i class="fas fa-caret-right fa-3x"></i></a>
<%						} %>
		  				</div>
					</div>
				</div>
				<div class="alert alert-info">
					<spring:message code="solicitud.confirmar.MensajeConfir"/>
				</div>	
				<form id="frmconfirmar" name="frmconfirmar" action="confirmar" method="post">
					<input name="estado" type="hidden">
					<div class="accordion" id="accordionExample">
  						<div class="accordion-item">
    						<h2 class="accordion-header" id="personalTitle">
						      	<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#personal" aria-expanded="true" aria-controls="personal">
									<spring:message code="solicitud.confirmar.InfoPersonal"/>
						      	</button>
   							</h2>
    						<div id="personal" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
      							<div class="accordion-body">
        							<dl class="form-group">
	        							<dt><spring:message code="adm.Nombre"/></dt>
	        							<dd><%=admUsuario.getNombre()%> <%=admUsuario.getApellidoPaterno()%> <%=admUsuario.getApellidoMaterno()==null ? "" : admUsuario.getApellidoMaterno()%></dd>
	        							<dt><spring:message code="solicitud.confirmar.LugarNacimiento"/>:</dt>
	        							<dd>
	        								<%=!admUsuario.getPaisId().equals("147") || ciudad==null ? "" : ciudad+"," %>
											<%=!admUsuario.getPaisId().equals("147") || estadoId==null ? "" : estadoId+","%>
	 										<%=paisId==null ? "" : paisId%>
	 									</dd>
	        							<dt><spring:message code="adm.Nacionalidad"/></dt>
	        							<dd><%=nacionalidad == null ? "" : nacionalidad %></dd>        
	        							<dt><spring:message code="solicitud.confirmar.FechaNacimiento"/></dt>
	        							<dd><%=admUsuario.getFechaNac() == null ? "" : admUsuario.getFechaNac()%></dd>
	        							<dt><spring:message code="solicitud.confirmar.Edad"/></dt>
	        							<dd><%=edad == null ? "" : edad%></dd>
<%			  							String estadoCivil = "-";
							            if(admUsuario.getEstadoCivil()!= null){
							              	if(admUsuario.getEstadoCivil().equals("C")){
							                	if(admUsuario.getGenero().equals("M")){
							                		estadoCivil="Married";
							                	}else {
							                		estadoCivil="Married";
							                	}
							              	}else if(admUsuario.getEstadoCivil().equals("S")){
								                if(admUsuario.getGenero().equals("M")){
								                	estadoCivil="Single / Never Married";
								                }else{
								                	estadoCivil="Single / Never Married";
								                }
						             		}else if(admUsuario.getEstadoCivil().equals("V")){
								                if(admUsuario.getGenero().equals("M")){
								                	estadoCivil="Widowed";
								                }else{
								                	estadoCivil="Widowed";
								                }
							             	}else if(admUsuario.getEstadoCivil().equals("D")){
								                if(admUsuario.getGenero().equals("M")){
								                	estadoCivil="Divorced";
								                }else{
								                	estadoCivil="Divorced";
								                }
											}
					            		}%>
	        							<dt><spring:message code="solicitud.confirmar.EstadoCivil"/></dt>
	        							<dd><%=estadoCivil%></dd>
								        <dt>Gender</dt>
								        <dd><%=admUsuario.getGenero()%></dd>
								        <dt><spring:message code="adm.Religion"/></dt>
								        <dd><%= religion == null ? "" : religion%></dd>					  					
								        <dt><spring:message code="solicitud.confirmar.Domicilio"/></dt>
								        <dd><%=admTutor.getCalle() == null ? "" : admTutor.getCalle()%> #<%=admTutor.getNumero() == null ? "" : admTutor.getNumero()%> <%=admTutor.getColonia() == null ? "" : admTutor.getColonia()%></dd>
								        <dt><spring:message code="solicitud.confirmar.Ubicacion"/></dt>
								        <dd> <%= !admTutor.getPaisId().equals("147") || cdUb == null ? "" : cdUb+","%> <%= !admTutor.getPaisId().equals("147") || edoUb == null ? "" : edoUb+","%>  <%= paisUb == null ? "" : paisUb%></dd>
<%-- 								        <dt><spring:message code="solicitud.confirmar.CodigoPostal"/></dt> --%>
<%-- 								        <dd><%=admTutor.getCodigoPostal() == null ? "" : admTutor.getCodigoPostal()%></dd> --%>
								        <dt><spring:message code="adm.Telefono"/></dt>
								        <dd><%=admTutor.getTelefono() == null ? "" : admTutor.getTelefono()%></dd>
								        <dt><spring:message code="solicitud.confirmar.CorreoElectronico"/></dt>
								        <dd><%=admUsuario.getEmail() == null ? "" : admUsuario.getEmail()%></dd>
	    							</dl>
      							</div>
    						</div>
  						</div>
  						<div class="accordion-item">
    						<h2 class="accordion-header" id="academicaTitle">
      							<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#academica" aria-expanded="false" aria-controls="academica">
       								<spring:message code="solicitud.confirmar.InfoAcademica"/>
      							</button>
    						</h2>
   	 						<div id="academica" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
      							<div class="accordion-body">
        							<dl class="form-group">
						          		<dt><spring:message code="solicitud.confirmar.CarreraDeseada"/></dt>
						          		<dd><%= nombreCarrera == null ? "" : nombreCarrera%></dd>
					          			<dt><spring:message code="solicitud.confirmar.YearPeriodo"/></dt>
						          		<dd><%=admAcademico.getFecha() == null ? "" : admAcademico.getFecha()%></dd>
						        	</dl>
      							</div>
    						</div>
  						</div>
  						<div class="accordion-item">
    						<h2 class="accordion-header" id="antecedentesTitle">
      							<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#antecedentes" aria-expanded="false" aria-controls="antecedentes">
       								<spring:message code="solicitud.confirmar.AntecedentesAcademicos"/>
      							</button>
    						</h2>
    						<div id="antecedentes" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
      							<div class="accordion-body">
        							<table width="80%" class="table table-bordered">
							          	<tr align="center">
							              	<td width="2%"><font color="blue"><b>#</b></font></td>
								            <td width="8%"><font color="blue"><b><spring:message code="solicitud.confirmar.Titulo"/></b></font></td>
								            <td width="9%"><font color="blue"><b><spring:message code="solicitud.confirmar.Institucion"/></b></font></td>
								            <td width="8%"><font color="blue"><b><spring:message code="adm.Pais"/></b></font></td>
								            <td width="7%"><font color="blue"><b><spring:message code="solicitud.confirmar.Completo"/></b></font></td>
								            <td width="7%"><font color="blue"><b>Year</b></font></td>
							         	</tr>
<%  								for(int i=0; i<lista.size(); i++){
			            				AdmEstudio tmp = (AdmEstudio)lista.get(i);
			            				String nombrePais = "";
			            				if(mapaPaises.containsKey(tmp.getPaisId())){
			            					nombrePais = mapaPaises.get(tmp.getPaisId()).getNombrePais();
			            				}%>
							            <tr class="tr2" align="center">
							                <td width="2%"><%=tmp.getId() == null ? "" : tmp.getId()%></td>
							                <td width="8%"><%=tmp.getTitulo() == null ? "" : tmp.getTitulo()%></td>
							                <td width="9%"><%=tmp.getInstitucion() == null ? "" : tmp.getInstitucion()%></td>
							                <td width="7%"><%=nombrePais%></td>
							                <td width="7%"><%=tmp.getCompleto() == null ? "" : tmp.getCompleto().equals("S")?"YES":"NO" %></td>
							                <td width="7%"><%=tmp.getFin() %></td>
							            </tr>
<%  								}%>
	        						</table>
      							</div>
    						</div>
  						</div>
  						<div class="accordion-item">
    						<h2 class="accordion-header" id="saludTitle">
      							<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#salud" aria-expanded="false" aria-controls="salud">
       								<spring:message code="solicitud.confirmar.InfoSalud"/>
      							</button>
    						</h2>
  							<div id="salud" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
      							<div class="accordion-body">
        							<dl class="form-group">
	          							<dt><spring:message code="solicitud.confirmar.Cronica"/></dt>
	          							<dd><%=admSalud.getEnfermedad() == null ? "" : admSalud.getEnfermedad().equals("S")?"YES":"NO" %>&nbsp;&nbsp;&nbsp;&nbsp;<%= admSalud.getEnfermedadDato()%></dd>
	        							<dt><spring:message code="solicitud.confirmar.Impedimento"/></dt>
	          							<dd><%=admSalud.getImpedimento() == null ? "" : admSalud.getImpedimento().equals("S")?"YES":"NO" %>&nbsp;&nbsp;&nbsp;&nbsp;<%= admSalud.getImpedimentoDato() %></dd>
	        						</dl>
     	 						</div>
    						</div>
						</div>
  						<div class="accordion-item">
    						<h2 class="accordion-header" id="padresTitle">
      							<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#padres" aria-expanded="false" aria-controls="padres">
       								<spring:message code="solicitud.confirmar.InfoPadres"/>
      							</button>
    						</h2>
    						<div id="padres" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
      							<div class="accordion-body">
        							<div class="row">
	        							<div class="col-md-6"> 
	        								<H4><spring:message code="solicitud.confirmar.Padre"/>:</H4>
	        								<label><spring:message code="adm.Nombre"/></label>
											<%=(admPadres.getPadreNombre() == null ? "" : admPadres.getPadreNombre())+" "+(admPadres.getPadreApellido() == null ? "" : admPadres.getPadreApellido())%><br>
											<label><spring:message code="adm.Religion"/>:</label>
											<%=padreReligion == null ? "" : padreReligion%><br>
											<label><spring:message code="adm.Nacionalidad"/>:</label>
											<%=padreNac  == null ? "" : padreNac%><br>
											<label><spring:message code="solicitud.confirmar.Ocupacion"/>:</label>
											<%=admPadres.getPadreOcupacion() == null ? "" : admPadres.getPadreOcupacion()%><br>
	        							</div>
							        	<div class="col-md-6"> 
						        			<h4><spring:message code="solicitud.confirmar.Madre"/>:</h4>
							        		<label><spring:message code="adm.Nombre"/>:</label>
											<%=(admPadres.getMadreNombre() == null ? "" : admPadres.getMadreNombre())+" "+(admPadres.getMadreApellido() == null ? "" : admPadres.getMadreApellido())%><br>
											<label><spring:message code="adm.Religion"/>:</label>
											<%=madreReligion == null ? "" : madreReligion %><br>
											<label><spring:message code="adm.Nacionalidad"/>:</label>
											<%=madreNac  == null ? "" : madreNac%><br>
											<label><spring:message code="solicitud.confirmar.Ocupacion"/>:</label>
											<%=admPadres.getMadreOcupacion() == null ? "" : admPadres.getMadreOcupacion()%><br>
							        	</div>
       								</div>
      							</div>
    						</div>
  						</div>
  						<div class="accordion-item">
    						<h2 class="accordion-header" id="colegiaturaTitle">
      							<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#colegiatura" aria-expanded="false" aria-controls="colegiatura">
       								<spring:message code="solicitud.confirmar.PersonaQuePaga"/>
      							</button>
    						</h2>
    						<div id="colegiatura" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
      							<div class="accordion-body">
<%  								String tutorInfo = "";
								 	if(admTutor.getTutor() != null){
										if(admTutor.getTutor().equals("0")){
											tutorInfo = "Father";
										}else if(admTutor.getTutor().equals("1")){
											tutorInfo = "Mother";
										}else if(admTutor.getTutor().equals("2")){
											tutorInfo = "Self Sponsored";
										}else if(admTutor.getTutor().equals("3")){
											tutorInfo = "Other";
										}
								 	}%>
							        	<dl class="form-group">
							          		<dt><%=tutorInfo %></dt>
<% 									if (tutorInfo.equals("Other")){%>
											<dd><%= admTutor.getNombre() == null ? "" : admTutor.getNombre()%></dd>
<% 									}%>
							        	</dl>
      							</div>
    						</div>
  						</div>
<%						if(!admAcademico.getCarreraId().equals("10501") && !admUsuario.getPaisId().equals("108") && !admAcademico.getNivelId().equals("5") && !admAcademico.getNivelId().equals("1")){ %>
  					  	<div class="accordion-item">
    						<h2 class="accordion-header" id="recomendantesTitle">
      							<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#recomendantes" aria-expanded="false" aria-controls="recomendantes">
      								<spring:message code="solicitud.confirmar.Recomendantes"/>
      							</button>
    						</h2>
						    <div id="recomendantes" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
						      	<div class="accordion-body">
<% 									for(int i=0; i<listaR.size(); i++){
										AdmRecomienda tmp = listaR.get(i);%>        
								      	<h4 class="panel-title">
											<spring:message code="solicitud.confirmar.RecoSugerido"/> <%=i+1%>:</a>
								      	</h4>
										<div class="form-group">
									  		<label for="Nombre"><b><spring:message code="adm.Nombre"/></b></label>
									  		<%=tmp.getNombre() == null ? "" : tmp.getNombre() %><br>
										  	<label for="Puesto"><b><spring:message code="solicitud.confirmar.CorreoElectronico"/></b></label>
										  	<%=tmp.getEmail() == null ? "" : tmp.getEmail() %><br>
										  	<label for="Email"><b><spring:message code="adm.Telefono"/></b></label>
										  	<%=tmp.getTelefono() == null ? "" : tmp.getTelefono() %><br>
										  	<label for="Email"><b>Address</b></label>
										  	<%=tmp.getDireccion() == null ? "" : tmp.getDireccion() %><br>
										</div>
										<br>
<%									}%>
						      	</div>
						    </div>
					  	</div>	
<%						}%>
 						<div class="accordion-item">
						    <h2 class="accordion-header" id="reglamentoTitle">
						      	<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#reglamento" aria-expanded="false" aria-controls="reglamento">
						        	<spring:message code="solicitud.confirmar.Reglamento"/>
						      	</button>
						    </h2>
						    <div id="reglamento" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
						      	<div class="accordion-body">
					        		<a href="../reglamento.pdf" target="_blank"><spring:message code="solicitud.confirmar.AbrirReglamento"/></a>
						      	</div>
						    </div>
					  	</div>
					</div>
					<div class="alert alert-success" align="center" width="80%">
		      			<p style="text-align:justify;font-size:16px;">
		      				<spring:message code="solicitud.confirmar.MensajeCompromiso"/>
			   			</p><br>
<%					if(admSolicitud.getEstado().equals("1")){ %>	
						<input type="checkbox" id="acepto" name="acepto" value="S"  onclick="javascript:botonConfirmar()" />
		  				&nbsp;&nbsp;<strong><spring:message code="solicitud.confirmar.AceptaTerminos"/></strong><br><br>
					  	<div style="display: none;" id="botonConf">
					  		<button type="button" class="btn btn-primary" onclick="javascript:confirmar();" align="center">
					 			<spring:message code="solicitud.confirmar.Confirmar"/> <span class="fas fa-thumbs-up" aria-hidden="true"></span>
							</button>
					  	</div>
<%					}%>
				 	</div>
<%				}else if(estado.equals("C")){%>
					<div class="text-center">
						<font color="black" size="5" align="center"><spring:message code="solicitud.confirmar.Procesando"/>...</font>
						<input type="image" disabled class="button" src="../imagenes/barraCargando.gif" value="Confirmar" onclick="javascript:confirmar()"/>
						<meta http-equiv="refresh" content="1;url=mandarCorreos" />
					</div>
<% 				}else{%>
					<br><br>
					<div class="page-header text-center">
						<h1><spring:message code="solicitud.confirmar.Felicidades"/></h1>
					</div>
					<div class="text-center">	
						<p style="font-size:20px;text-align:center;"><spring:message code="solicitud.confirmar.SolicitudCompleta"/></p><br>
						<button type="button" class="btn alert-info" onclick="document.location.href='../documentos/documentos';">
				 			<spring:message code="solicitud.confirmar.Aceptar"/> <span class="fas fa-check fa-2x" aria-hidden="true"></span>
						</button>
					</div>
<%				}%>
				</form>
			</div>
		</div>
	</div>
</body>