<%@ page import="java.util.List"%>
<%@ page import="adm.alumno.spring.AdmPadres"%>
<%@ page import="adm.alumno.spring.AdmSolicitud"%>
<%@ page import="adm.alumno.spring.AdmCartaSubir"%>
<%@ page import="adm.catalogo.spring.CatPais"%>
<%@ page import="adm.catalogo.spring.CatReligion"%>

<%@ include file= "../head.jsp"%>
<%@ include file= "../menu.jsp"%>
<html>
<head> 
	<link rel="STYLESHEET" href="/admision.css"  type="text/css">
	<script src="js/jquery-1.5.1.min.js" type="text/javascript"></script>
  	<script src='js/Globo/jquery.tinyTips2.js' type='text/javascript'></script>		
	<style>		
		body{
			background-image: url("<%=request.getContextPath()%>/imagenes/Biblioteca.png");
			/* Para dejar la imagen de fondo centrada, vertical y horizontalmente */
			background-position: center center;
			/* La imagen se fija en la ventana de visualizaci�n para que la altura de la imagen no supere a la del contenido */
			background-attachment: fixed;
			background-repeat: no-repeat;
			/* La imagen de fondo se reescala autom�ticamente con el cambio del ancho de ventana del navegador */
			background-size: cover;	
		} 
		a {text-decoration: none;} 
		a:hover {text-decoration: underline;} 
		.tabla td{padding:5px;}
		
		.tinyTip {
			width: 325px;
			padding: 17px 0px 0px 0px;
			display: block;
			background: url(js/Globo/tinyTip-top.png) 0px 0px no-repeat;
		}
		.tinyTip .content {
			padding: 0px 15px 0px 15px;
			font-size: 14px;
			font-family: "Lucida Sans Unicode";
			color: #010101;
			background: url(js/Globo/tinyTip-content.png) 0px 0px repeat-y;
		}
		.tinyTip .bottom {
			height: 47px;
			background: url(js/Globo/tinyTip-bottom.png) 0px 0px no-repeat;
			font: 0px/0px sans-serif;
		}
		.fa{
			color: black;
		}
		a> .fa{
			color: #337ab7;
		}
		
		@media (min-width: 587px) {
			.col-md-3{
				float: left;
				margin-left: 85px;
			}
		}
		@media (min-width: 764px) {
			.col-md-3{
				float: left;
				margin-left: 0;
			}		
		}
		@media (min-width: 480px) {
			.col-md-5{
				float: left;
			}
		}	
	</style>	
	<script type="text/javascript">
		function revisaPadre(){
			if(document.getElementById("nombrePadre").value != ""){
				if(document.getElementById("apellidoPadre").value != ""){
					if(document.getElementById("ocupacionPadre").value != ""){
						if(document.getElementById("nacionalidadPadre").value != "0"){
							if(document.getElementById("religionPadre").value != "0"){
								return true;
							}
							else{
								alert("Father's religion is required");
								document.getElementById("religionPadre").focus();
							}
						}
						else{
							alert("Fathers ");
							document.getElementById("nacionalidadPadre").focus();
						}
					}
					else{
						alert("La ocupaci�n del padre es requerida");
						document.getElementById("ocupacionPadre").focus();
					}
				}
				else{
					alert("El apellido del padre es requerido");
					document.getElementById("apellidoPadre").focus();	
				}
			}
			else{
				alert("El nombre del padre es requerido");
				document.getElementById("nombrePadre").focus();
			}
			return false;
		}

		function revisaMadre(){
			if(document.getElementById("nombreMadre").value != ""){
				if(document.getElementById("apellidoMadre").value != ""){
					if(document.getElementById("ocupacionMadre").value != ""){
						if(document.getElementById("nacionalidadMadre").value != "0"){
							if(document.getElementById("religionMadre").value != "0"){
								return true;
							}
							else{
								alert("La religi�n de la madre es requerida");
								document.getElementById("religionMadre").focus();
							}
						}
						else{
							alert("La nacionalidad de la madre es requerida");
							document.getElementById("nacionalidadMadre").focus();
						}
					}
					else{
						alert("La ocupaci�n de la madre es requerida");
						document.getElementById("ocupacionMadre").focus();
					}
				}
				else{
					alert("El apellido de la madre es requerido");
					document.getElementById("apellidoMadre").focus();	
				}
			}
			else{
				alert("El nombre de la madre es requerido");
				document.getElementById("nombreMadre").focus();
			}
			return false;
		}
		
		function grabar(){

			var checkboxPadre 	= $("#VivePadre");
			var checkboxMadre 	= $("#ViveMadre");
			var save = 0;

			if (checkboxPadre.is(':checked')) {
				if(revisaPadre()){
					save++;
				}
			}else{
				save++;
			}
			if (checkboxMadre.is(':checked')) {
				if(revisaMadre()){
					save++;
				}
			}else{
				save++;
			}
			
			if(save === 2){
				document.formPadres.submit();
			}
		}

		$(function() {

			var checkboxPadre 	= $("#VivePadre");
			var hiddenPadre 	= $("#hidden_padre");

			 if (checkboxPadre.is(':checked')) {
				 hiddenPadre.show();
			 } else {
		    	hiddenPadre.hide();
		    	document.getElementById("nombrePadre").value="-";
		    	document.getElementById("apellidoPadre").value="-";
		    	document.getElementById("ocupacionPadre").value="-";
		    	document.getElementById("nacionalidadPadre").value="0";
		    	document.getElementById("religionPadre").value="0";
			 }
			  
			 checkboxPadre.change(function() {
			    if (checkboxPadre.is(':checked')) {
			    	hiddenPadre.show();
			    } else {
			    	hiddenPadre.hide();
			    	document.getElementById("nombrePadre").value="-";
			    	document.getElementById("apellidoPadre").value="-";
			    	document.getElementById("ocupacionPadre").value="-";
			    	document.getElementById("nacionalidadPadre").value="0";
			    	document.getElementById("religionPadre").value="0";
			    }
			  });

			var checkboxMadre = $("#ViveMadre");
			var hiddenMadre = $("#hidden_madre");

			 if (checkboxMadre.is(':checked')) {
				 hiddenMadre.show();
			    } else {
			    	hiddenMadre.hide();
			    	document.getElementById("nombreMadre").value="-";
			    	document.getElementById("apellidoMadre").value="-";
			    	document.getElementById("ocupacionMadre").value="-";
			    	document.getElementById("nacionalidadMadre").value="0";
			    	document.getElementById("religionMadre").value="0";
			    }
			  
			 checkboxMadre.change(function() {
			    if (checkboxMadre.is(':checked')) {
			    	hiddenMadre.show();
			    } else {
			    	hiddenMadre.hide();
			    	document.getElementById("nombreMadre").value="-";
			    	document.getElementById("apellidoMadre").value="-";
			    	document.getElementById("ocupacionMadre").value="-";
			    	document.getElementById("nacionalidadMadre").value="0";
			    	document.getElementById("religionMadre").value="0";
			    }
			  });
		});
	</script>
</head>
<%	
	String folio			= (String) session.getAttribute("Folio")==null?"0":(String)session.getAttribute("Folio");
	List<String> opciones	= (List<String>)session.getAttribute("Opciones");
	String mensaje			= request.getParameter("Mensaje")==null?"0":request.getParameter("Mensaje");
	boolean existe 			= (boolean) request.getAttribute("existe");	
	String colorGrabar		= existe?"style='color:purple'":"style='color:orange'";
	
	AdmPadres admPadres 			= (AdmPadres) request.getAttribute("admPadres");
	AdmSolicitud admSolicitud 		= (AdmSolicitud) request.getAttribute("admSolicitud");	
	AdmCartaSubir admCartaSubir 	= (AdmCartaSubir)request.getAttribute("admCartaSubir");
	List<CatPais> lisPais			= (List<CatPais>) request.getAttribute("lisPais");
	List<CatReligion> lisReligion	= (List<CatReligion>) request.getAttribute("lisReligion");	
%>
<body>
	<div class="container-fluid">
		<div class="row">
			<%@ include file= "../opciones.jsp"%>
			<div class="col-lg-11" style="background-color:white; min-height:calc(100vh - 37px);">
				<div class="d-flex bd-highlight page-header">
					<div class="p-2 w-100 bd-highlight">			
						<h2><i class="fas fa-check-circle" aria-hidden="true" <%=colorGrabar%>></i>&nbsp;<spring:message code="solicitud.padres.InformacionFamiliar"/></h2>
					</div>
					<div class="p-2 flex-shrink-1 bd-highlight">
						<div class="d-flex align-items-center">
				    		<a href="<%=request.getContextPath()%>/solicitud/datos"><i class="fas fa-caret-left fa-3x"></i></a>
				    		&nbsp;<b class="fs-5">3/8</b>&nbsp;
<% 				if(existe){%>
<%-- 				    		<a href="<%=request.getContextPath()%>/solicitud/estudios"><i class="fas fa-caret-right fa-3x"></i></a> --%>
				    		<a href="<%=request.getContextPath()%>/solicitud/otroEstudio"><i class="fas fa-caret-right fa-3x"></i></a>
<%				}else{
					out.print("&nbsp;");
				}
%>	      
						</div>
					</div>				
				</div>
				<div class="alert alert-info" role="alert">
					<p> <spring:message code="solicitud.padres.Mensaje1"/>
				</div>
				<form id="formPadres" name="formPadres" method="post" action="grabarPadres">
					<div class="row">
						<div class="col-md-6">
							<h3><spring:message code="solicitud.padres.InfoPadre"/></h3>
							<label><spring:message code="solicitud.padres.Vivo"/></label><br>							
							<input type="checkbox" name="VivePadre" id="VivePadre" value="S" <%=admPadres.getVivePadre().equals("S")?"checked":""%>><br><br>
								
							<div id="hidden_padre">
								<label><spring:message code="solicitud.padres.Nombre"/>:</label>
								<input type="text" class="form-control" id="nombrePadre" name="nombrePadre" value="<%=admPadres.getPadreNombre()==null ? "" : admPadres.getPadreNombre() %>" size="30" maxlength="50" />
								<br><br>
								<label><spring:message code="solicitud.padres.Apellido"/>:</label>
								<input type="text" class="form-control" id="apellidoPadre" name="apellidoPadre" value="<%=admPadres.getPadreApellido()==null ? "" : admPadres.getPadreApellido() %>" size="30" maxlength="50" />
								<br><br>
								<label><spring:message code="solicitud.padres.Ocupacion"/>:</label>
								<input type="text" class="form-control" id="ocupacionPadre" name="ocupacionPadre" value="<%=admPadres.getPadreOcupacion()==null ? "" : admPadres.getPadreOcupacion() %>" size="30" maxlength="40" />
								<br><br>
								<label><spring:message code="solicitud.padres.Nacionalidad"/>:</label>
								<select class="form-select selectpicker" id="nacionalidadPadre" name="nacionalidadPadre"  data-live-search="true">
									<option value="0" selected><spring:message code="solicitud.padres.SelecNacionalidad"/> </option>
<%										String nacionalidadId = "91";
										if(admPadres.getPadreNacionalidad()!=null && !admPadres.getPadreNacionalidad().equals("")){
											nacionalidadId = admPadres.getPadreNacionalidad();
										}
										for (CatPais pais : lisPais){ %>
											<option value="<%=pais.getPaisId() %>" <%= pais.getPaisId().equals(nacionalidadId) ? "Selected" : "" %>><%=pais.getNacionalidad() %></option>
<%										}%>
									</select>
									<br><br>
									<label><spring:message code="solicitud.padres.Religion"/></label>
									<select class="form-select" id="religionPadre" name="religionPadre" >
										<option value="0" selected><spring:message code="solicitud.padres.SelecReligion"/> </option>
<%										String religionId = "0";
										if(admPadres.getPadreReligion()!=null){
										religionId = admPadres.getPadreReligion();
										}
										for (CatReligion religion : lisReligion){ %>
											<option value="<%=religion.getReligionId() %>" <%=religion.getReligionId().equals(religionId) ? "Selected" : "" %>><%=religion.getNombreReligion() %></option>
<%										}%>
								</select>
								<br><br> 
							</div>
						</div>
						<div class="col-md-6">
							<h3><spring:message code="solicitud.padres.InfoMadre"/></h3>
							<label><spring:message code="solicitud.padres.Viva"/></label><br>
							<input type="checkbox" name="ViveMadre" id="ViveMadre" value="S" <%=admPadres.getViveMadre().equals("S")?"checked":""%>><br><br>
							<div id="hidden_madre">
								<label><spring:message code="solicitud.padres.Nombre"/>:</label>
								<input type="text" class="form-control" id="nombreMadre" name="nombreMadre" value="<%=admPadres.getMadreNombre()==null ? "" : admPadres.getMadreNombre() %>" size="30" maxlength="50" />
								<br><br>
								<label><spring:message code="solicitud.padres.Apellido"/>:</label>
								<input type="text" class="form-control" id="apellidoMadre" name="apellidoMadre" value="<%=admPadres.getMadreApellido()==null ? "" : admPadres.getMadreApellido() %>" size="30" maxlength="50" />
								<br><br>
								<label><spring:message code="solicitud.padres.Ocupacion"/>:</label>
								<input type="text" class="form-control" id="ocupacionMadre" name="ocupacionMadre" value="<%=admPadres.getMadreOcupacion()==null ? "" : admPadres.getMadreOcupacion() %>" size="30" maxlength="40" />
								<br><br>
								<label><spring:message code="solicitud.padres.Nacionalidad"/>:</label>
								<select class="form-select selectpicker" id="nacionalidadMadre" name="nacionalidadMadre"  data-live-search="true">
									<option value="0" selected><spring:message code="solicitud.padres.SelecNacionalidad"/> </option>
								<%	nacionalidadId = "91";
									if(admPadres.getMadreNacionalidad()!=null && !admPadres.getMadreNacionalidad().equals("")){
										nacionalidadId = admPadres.getMadreNacionalidad();
									}
									for (CatPais pais : lisPais){ %>
								       	<option value="<%=pais.getPaisId() %>" <%= pais.getPaisId().equals(nacionalidadId) ? "Selected" : "" %>><%=pais.getNacionalidad() %></option>
								    <%	}%>
								</select>
								<br><br>
								<label><spring:message code="solicitud.padres.Religion"/></label>
								<select class="form-select" id="religionMadre" name="religionMadre" >
								<option value="0" selected><spring:message code="solicitud.padres.SelecReligion"/> </option>
									<%	religionId = "0";
									if(admPadres.getMadreReligion()!=null){
										religionId = admPadres.getMadreReligion();
									}
									for (CatReligion religion : lisReligion){ %>
										<option value="<%=religion.getReligionId() %>" <%=religion.getReligionId().equals(religionId)?"Selected":"" %>><%=religion.getNombreReligion() %></option>
								     <%	}%>
								</select>
								<br><br>
							</div>
						</div>
					</div>
<%		if(admSolicitud.getEstado().equals("1")){ %>	
					<button type="button" class="btn alert-info" onclick="grabar();">
						 <spring:message code="adm.Guardar"/> <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
					</button>
<%		} %>
				</form>
			</div>
		</div>
	</div>
</body>
</html>
<% if (mensaje.equals("1")){%>
	<table align="center"><tr><td><spring:message code="solicitud.padres.Grabo"/></td></tr></table>
<!-- 	<meta http-equiv="refresh" content="1;url=estudios" /> -->
	<meta http-equiv="refresh" content="1;url=otroEstudio" />
<%}else if(mensaje.equals("2")){%>
	<table align="center"><tr><td><spring:message code="solicitud.padres.NoGrabo"/></td></tr></table>
<%}%>
